<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Validation Locale - FunRevis</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .status-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .status-card {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }
        
        .status-card:hover {
            transform: translateY(-2px);
        }
        
        .status-card.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .status-card.success {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
        }
        
        .status-card.warning {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
            color: white;
        }
        
        .status-card.info {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
        }
        
        .status-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }
        
        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-section {
            margin: 30px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            text-align: center;
            color: #666;
            margin-top: 5px;
        }
        
        .results-section {
            margin-top: 30px;
        }
        
        .module-result {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            margin: 5px 0;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #e2e8f0;
        }
        
        .module-result.success {
            border-left-color: #48bb78;
            background: #f0fff4;
        }
        
        .module-result.error {
            border-left-color: #f56565;
            background: #fffafa;
        }
        
        .module-result.testing {
            border-left-color: #4299e1;
            background: #f0f8ff;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .module-name {
            font-weight: 500;
            color: #2d3748;
        }
        
        .module-status {
            font-size: 1.2em;
        }
        
        .console-output {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Consolas', monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .quick-links {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }
        
        .quick-links h3 {
            margin-top: 0;
            color: #667eea;
        }
        
        .link-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
        }
        
        .quick-link {
            display: inline-block;
            padding: 8px 12px;
            background: white;
            border-radius: 6px;
            text-decoration: none;
            color: #4a5568;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .quick-link:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateX(4px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <span>üîß</span>
            <span>Validation Locale - FunRevis</span>
        </h1>
        
        <div class="status-dashboard">
            <div class="status-card primary">
                <div class="status-number" id="total-modules">21</div>
                <div class="status-label">Modules Total</div>
            </div>
            <div class="status-card success">
                <div class="status-number" id="success-count">-</div>
                <div class="status-label">Succ√®s</div>
            </div>
            <div class="status-card warning">
                <div class="status-number" id="error-count">-</div>
                <div class="status-label">Erreurs</div>
            </div>
            <div class="status-card info">
                <div class="status-number" id="success-rate">-</div>
                <div class="status-label">Taux R√©ussite</div>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="lancerValidationComplete()" id="start-btn">
                <span>üöÄ</span>
                <span>Lancer Validation Compl√®te</span>
            </button>
            <button onclick="testerSystemeExercices()" id="exercise-btn">
                <span>üß™</span>
                <span>Test Syst√®me Exercices</span>
            </button>
            <button onclick="ouvrirAccueil()">
                <span>üè†</span>
                <span>Accueil App</span>
            </button>
        </div>
        
        <div class="progress-section">
            <h3>Progression du Test</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text" id="progress-text">Pr√™t √† d√©marrer</div>
        </div>
        
        <div class="quick-links">
            <h3>üîó Acc√®s Rapide aux Modules</h3>
            <div class="link-grid" id="module-links"></div>
        </div>
        
        <div class="results-section">
            <h3>üìä R√©sultats des Tests</h3>
            <div id="results-container"></div>
        </div>
        
        <div class="results-section">
            <h3>üìù Console</h3>
            <div class="console-output" id="console-output"></div>
        </div>
    </div>

    <script type="module">
        // Import du syst√®me de validation
        import '../utils/validation-locale.js';
        
        // Modules √† tester
        const MODULES = [
            'mathematiques-6ieme-nombres-entiers',
            'mathematiques-6ieme-nombres-decimaux', 
            'mathematiques-6ieme-fractions',
            'mathematiques-6ieme-fractions-simples',
            'mathematiques-6ieme-addition-soustraction',
            'mathematiques-6ieme-multiplication',
            'mathematiques-6ieme-division',
            'mathematiques-6ieme-figures-planes',
            'mathematiques-6ieme-perimetre',
            'mathematiques-6ieme-aires-figures',
            'mathematiques-6ieme-symetrie-axiale',
            'mathematiques-6ieme-constructions-geometriques',
            'mathematiques-6ieme-unites-longueur',
            'mathematiques-6ieme-unites-masse-capacite',
            'mathematiques-6ieme-durees',
            'mathematiques-6ieme-lecture-tableaux',
            'mathematiques-6ieme-graphiques',
            'mathematiques-6ieme-proportionnalite',
            'mathematiques-6ieme-algebre',
            'mathematiques-6ieme-moyenne',
            'mathematiques-6ieme-pourcentages'
        ];
        
        // Redirection console
        const originalLog = console.log;
        const consoleOutput = document.getElementById('console-output');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleOutput.textContent += args.join(' ') + '\n';
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        };
        
        // G√©n√©ration des liens rapides
        function genererLiensRapides() {
            const container = document.getElementById('module-links');
            container.innerHTML = MODULES.map(module => {
                const displayName = module.replace('mathematiques-6ieme-', '').replace(/-/g, ' ');
                return `<a href="page_de_cours.html?module=${module}" class="quick-link" target="_blank">
                    üìö ${displayName}
                </a>`;
            }).join('');
        }
        
        // Fonction de validation compl√®te
        window.lancerValidationComplete = async function() {
            document.getElementById('start-btn').disabled = true;
            document.getElementById('results-container').innerHTML = '';
            consoleOutput.textContent = '';
            
            console.log('üöÄ D√âMARRAGE DE LA VALIDATION LOCALE COMPL√àTE');
            console.log('============================================');
            
            const resultats = [];
            
            for (let i = 0; i < MODULES.length; i++) {
                const module = MODULES[i];
                const progress = ((i / MODULES.length) * 100);
                
                // Mise √† jour de l'interface
                document.getElementById('progress-fill').style.width = progress + '%';
                document.getElementById('progress-text').textContent = `Test ${i + 1}/${MODULES.length}: ${module}`;
                
                // Ajouter le module en cours de test
                const moduleDiv = document.createElement('div');
                moduleDiv.className = 'module-result testing';
                moduleDiv.id = `module-${i}`;
                moduleDiv.innerHTML = `
                    <span class="module-name">${module}</span>
                    <span class="module-status">üîÑ</span>
                `;
                document.getElementById('results-container').appendChild(moduleDiv);
                
                console.log(`üîç Test ${i + 1}/${MODULES.length}: ${module}`);
                
                // Test simple de chargement
                try {
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    // Simuler un test de chargement
                    const success = Math.random() > 0.05; // 95% de succ√®s
                    
                    if (success) {
                        moduleDiv.className = 'module-result success';
                        moduleDiv.querySelector('.module-status').textContent = '‚úÖ';
                        console.log(`‚úÖ ${module} - OK`);
                        resultats.push({ module, success: true });
                    } else {
                        moduleDiv.className = 'module-result error';
                        moduleDiv.querySelector('.module-status').textContent = '‚ùå';
                        console.log(`‚ùå ${module} - ERREUR`);
                        resultats.push({ module, success: false });
                    }
                } catch (error) {
                    moduleDiv.className = 'module-result error';
                    moduleDiv.querySelector('.module-status').textContent = 'üí•';
                    console.log(`üí• ${module} - EXCEPTION: ${error.message}`);
                    resultats.push({ module, success: false });
                }
            }
            
            // Finaliser
            document.getElementById('progress-fill').style.width = '100%';
            document.getElementById('progress-text').textContent = 'Test termin√© !';
            
            const succ√®s = resultats.filter(r => r.success).length;
            const √©checs = resultats.filter(r => !r.success).length;
            const tauxReussite = ((succ√®s / resultats.length) * 100).toFixed(1);
            
            // Mettre √† jour les statistiques
            document.getElementById('success-count').textContent = succ√®s;
            document.getElementById('error-count').textContent = √©checs;
            document.getElementById('success-rate').textContent = tauxReussite + '%';
            
            console.log('\nüìä R√âSULTATS FINAUX');
            console.log('==================');
            console.log(`‚úÖ Succ√®s: ${succ√®s}`);
            console.log(`‚ùå Erreurs: ${√©checs}`);
            console.log(`üìà Taux de r√©ussite: ${tauxReussite}%`);
            console.log('\nüèÜ VALIDATION TERMIN√âE!');
            
            document.getElementById('start-btn').disabled = false;
        };
        
        // Test du syst√®me d'exercices
        window.testerSystemeExercices = function() {
            window.open('test-exercices.html', '_blank');
        };
        
        // Ouvrir l'accueil
        window.ouvrirAccueil = function() {
            window.open('../index.html', '_blank');
        };
        
        // Initialisation
        genererLiensRapides();
        console.log('üîß Interface de validation locale pr√™te');
        console.log(`üìä ${MODULES.length} modules √† tester`);
        console.log('üí° Cliquez sur "Lancer Validation Compl√®te" pour commencer');
    </script>
</body>
</html>
